var jic={compress:function(a,b,d){var e='image/jpeg';'undefined'!=typeof d&&'png'===d&&(e='image/png');var f=document.createElement('canvas');f.width=a.naturalWidth,f.height=a.naturalHeight;var g=f.getContext('2d').drawImage(a,0,0),h=f.toDataURL(e,b/100),i=new Image;return i.src=h,i},upload:function(a,b,d,e,f,g,h,i){void 0===XMLHttpRequest.prototype.sendAsBinary&&(XMLHttpRequest.prototype.sendAsBinary=function(o){var p=Array.prototype.map.call(o,function(q){return 255&q.charCodeAt(0)});this.send(new Uint8Array(p).buffer)});var j='image/jpeg';'.png'===e.substr(-4).toLowerCase()&&(j='image/png');var k=a.src;k=k.replace('data:'+j+';base64,','');var l=new XMLHttpRequest;l.open('POST',b,!0);var m='someboundary';if(l.setRequestHeader('Content-Type','multipart/form-data; boundary='+m),i&&'object'==typeof i)for(var n in i)l.setRequestHeader(n,i[n]);h&&h instanceof Function&&(l.upload.onprogress=function(o){o.lengthComputable&&h(100*(o.loaded/o.total))}),l.sendAsBinary(['--'+m,'Content-Disposition: form-data; name="'+d+'"; filename="'+e+'"','Content-Type: '+j,'',atob(k),'--'+m+'--'].join('\r\n')),l.onreadystatechange=function(){4===this.readyState&&(200===this.status?f(this.responseText):400<=this.status&&g&&g instanceof Function&&g(this.responseText))}}};module.exports=jic;